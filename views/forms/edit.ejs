<% layout('layouts/boilerplateShow')%>
<div class="container vh-80 d-flex flex-column justify-content-center">
    <div class="row">
        <h1 class="display-1 text-center">Promjeni narudžbu</h1>
        <div class="col-lg-6 offset-lg-3">
            <form
                action="/show/<%= template._id %>/edit?_method=PUT"
                method="POST"
                novalidate
                class="validated-form"
                enctype="multipart/form-data"
            >
                <% Object.entries(fieldType).forEach((key, i) => {%> <% if (i %
                2 == 0) {%>
                <div class="row">
                    <div class="col">
                        <div class="mb-3">
                            <% if (key[1].type == "more") {%>
                            <label for="category<%= i %>" class="form-label"
                                ><%= key[1].name %></label
                            >
                            <select
                                class="form-select"
                                id="category<%= i %>"
                                name="form[category]"
                            >
                                <% for (let j = 0; j <
                                key[1].additional[0].length; j++) {%> <option
                                value="<%= key[1].additional[0][j] %>" <%=
                                key[1].additional[0][j] ===
                                template.fields[i].value ? "selected" : ""%> >
                                <%= key[1].additional[0][j] %> <% } %>
                            </select>
                            <% } else {%>
                            <label for="category<%= i %>" class="form-label"
                                ><%= key[1].name %></label
                            >
                            <input
                                type="<%= key[1].type %>"
                                class="form-control category-name"
                                id="category<%= i %>"
                                name="form[category]"
                                value="<%= template.fields[i].value %>"
                            />
                            <% } %>
                        </div>
                    </div>
                    <% } else { %>
                    <div class="col">
                        <div class="mb-3">
                            <% if (key[1].type == "more") {%>
                            <label for="category<%= i %>" class="form-label"
                                ><%= key[1].name %></label
                            >
                            <select
                                class="form-select"
                                id="category<%= i %>"
                                name="form[category]"
                            >
                                <% for (let j = 0; j < key[1].additional.length;
                                j++) {%>
                                <option value="<%= key[1].additional[0][j]%>">
                                    <%= key[1].additional[0][j]%>
                                </option>
                                <% } %>
                            </select>
                            <% } else {%>
                            <label for="category<%= i %>" class="form-label"
                                ><%= key[1].name %></label
                            >
                            <input
                                type="<%= key[1].type %>"
                                class="form-control category-name"
                                id="category<%= i %>"
                                name="form[category]"
                                value="<%= template.fields[1].value %>"
                            />
                            <% } %>
                        </div>
                    </div>
                </div>
                <% } %> <% }) %>
                <div class="mb-3">
                    <label for="file" class="form-label">Unesi file:</label>
                    <input
                        class="form-control"
                        type="file"
                        id="file"
                        name="image"
                        multiple
                    />
                </div>
                <div class="mb-3">
                    <div class="row">
                        <h3 class="text-center">Priložene datoteke</h3>
                        <% template.attachments.forEach(function(file, i) { %>
                        <% if (template.attachments.length !== 1) { %> <% if
                        (file.url.slice(-3) == "pdf") { %>
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <embed
                                        height="500px"
                                        width="100%"
                                        name="plugin"
                                        src="<%= file.url %>"
                                        type="application/pdf"
                                    />
                                </div>

                                <div class="card-body">
                                    <div class="form-check-inline">
                                        <input
                                            type="checkbox"
                                            class="btn-check"
                                            id="file<%=i%>"
                                            name="deleteImages[]"
                                            value="<%=file.filename%>"
                                            autocomplete="off"
                                        />
                                        <label
                                            class="btn btn-outline-dark"
                                            for="file<%=i%>"
                                            >Checkbox 1</label
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>
                        <% } else { %>
                        <div class="col-lg-6">
                            <div class="card">
                                <div class="card-body">
                                    <img
                                        src="<%= file.url %>"
                                        class="img-fluid"
                                    />
                                </div>

                                <div class="card-body">
                                    <div class="form-check-inline">
                                        <input
                                            type="checkbox"
                                            class="btn-check"
                                            id="file<%=i%>"
                                            name="deleteImages[]"
                                            value="<%=file.filename%>"
                                            autocomplete="off"
                                        />
                                        <label
                                            class="btn btn-outline-dark"
                                            for="file<%=i%>"
                                            >Checkbox 1</label
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>
                        <% } %> <% } else { %> <% if (file.url.slice(-3) ==
                        "pdf") { %>
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-body">
                                    <embed
                                        height="500px"
                                        width="100%"
                                        name="plugin"
                                        src="<%= file.url %>"
                                        type="application/pdf"
                                    />
                                </div>

                                <div class="card-body">
                                    <div class="form-check-inline">
                                        <input
                                            type="checkbox"
                                            class="btn-check"
                                            id="file<%=i%>"
                                            name="deleteImages[]"
                                            value="<%=file.filename%>"
                                            autocomplete="off"
                                        />
                                        <label
                                            class="btn btn-outline-dark"
                                            for="file<%=i%>"
                                            >Checkbox 1</label
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>
                        <% } else { %>
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-body">
                                    <img
                                        src="<%= file.url %>"
                                        class="img-fluid"
                                    />
                                </div>

                                <div class="card-body">
                                    <div class="form-check-inline">
                                        <input
                                            type="checkbox"
                                            class="btn-check"
                                            id="file<%=i%>"
                                            name="deleteImages[]"
                                            value="<%=file.filename%>"
                                            autocomplete="off"
                                        />
                                        <label
                                            class="btn btn-outline-dark"
                                            for="file<%=i%>"
                                            >Checkbox 1</label
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>
                        <% } %> <% } %> <% }) %>
                    </div>
                </div>
                <button class="btn btn-dark my-3">Spremi</button>
            </form>
        </div>
    </div>
</div>
